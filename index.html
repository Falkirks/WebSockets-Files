<!DOCTYPE html>
<html>
<head>
<script src="http://cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/alertify.js/0.3.0/alertify.min.js"></script>
<script type="text/javascript" src="./assets/delivery.js"></script>
<script type="text/javascript" src="./assets/alertify.min.js"></script>
<link rel="stylesheet" type="text/css" href="./assets/alertify.core.css">
<link rel="stylesheet" type="text/css" href="./assets/alertify.default.css">
<style type="text/css">
#holder{
 width: 100%;
 height: 100%;

}
.icon {
    display: inline-block;
    vertical-align: middle;
}
.icon--plus > path {
    fill: white;
    stroke: black;
    stroke-width: 0.1;
    stroke-linejoin: round;
}
.hover{
  background-color: black;
}
</style>
</head>
<body>
<div id="holder"><svg class="icon  icon--plus" viewBox="0 0 5 5" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 1 h1 v1 h1 v1 h-1 v1 h-1 v-1 h-1 v-1 h1 z" />
</svg></div>
<script>
var holder = document.getElementById('holder');
holder.ondragover = function () { this.className = 'hover'; return false; };
holder.ondragend = function () { this.className = ''; return false; };
</script>
<script>
  var socket = io.connect('http://localhost:8080');
  socket.on('connect', function () {
    socket.on('disconnect', function () { alertify.error("Socket disconnected."); });
    socket.on('error', function () { alertify.error("Unexpected error occured."); })
    socket.emit('join', { chan: window.location.pathname});
  	 var delivery = new Delivery(socket);
         alertify.success("Socket connected.");
      delivery.on('receive.start',function(fileUID){
        alertify.log("Starting file transfer.");
      });
    delivery.on('receive.success',function(file){
      alertify.confirm("Accept new file with " + file.uid, function (e) {
        if (e){
          alertify.log("Saving file.");
          //Save file
        }
       });
      });
      holder.ondrop = function (e) {
  this.className = '';
  e.preventDefault();
  var file = e.dataTransfer.files[0];
  delivery.send(file);
  console.log(file);
  return false;
};
  });
</script>
</body>
</html>